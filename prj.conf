# Console and Shell
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
# Shell: interrupt-driven (stable; avoid Nordic async issues)
CONFIG_SHELL=y
CONFIG_SHELL_BACKEND_SERIAL=y

# RS485 DE: apply patches/0001-shell-uart-rs485-de.patch to Zephyr
CONFIG_SHELL_BACKEND_SERIAL_RS485_DE=y
CONFIG_SHELL_RS485_DE_GPIO_PIN=21
# Delay (ms) before DE low after TX. 3=balance; 4-5=less garbled; 2=faster RX (Enter) but more garbled
CONFIG_SHELL_RS485_DE_OFF_DELAY_MS=1
# Delay (us) after DE high before first byte; fixes "art:~$" -> "uart:~$"
CONFIG_SHELL_RS485_DE_ON_DELAY_US=250
# Max DE high (ms); force low after so RX/Enter works
CONFIG_SHELL_RS485_DE_MAX_HIGH_MS=10
CONFIG_SHELL_BACKEND_SERIAL_API_ASYNC=n
CONFIG_UART_INTERRUPT_DRIVEN=y

# Shell init priority lower than UART driver (avoid Hard Fault)
CONFIG_SHELL_BACKEND_SERIAL_INIT_PRIORITY=95

CONFIG_SHELL_STACK_SIZE=4096
CONFIG_SHELL_BACKEND_SERIAL_CHECK_DTR=n
# UARTE1 (UART1)
CONFIG_UART_NRFX=y
CONFIG_NRFX_UARTE1=y

# Interrupt-driven; no UART async
# CONFIG_UART_ASYNC_API=y
# CONFIG_UART_1_NRF_HW_ASYNC=y
# CONFIG_UART_1_NRF_HW_ASYNC_TIMER=4
# CONFIG_NRFX_PPI=y

# debug
CONFIG_PRINTK=y
CONFIG_LOG=y
# 讓 Logger 訊息導向 Shell
CONFIG_SHELL_LOG_BACKEND=y
# 設定 Logger 為非同步模式
CONFIG_LOG_MODE_DEFERRED=y
CONFIG_LOG_BUFFER_SIZE=4096

# GPIO 和 LED
CONFIG_GPIO=y

# 開啟 I2C Shell 指令集
CONFIG_I2C=y
CONFIG_I2C_SHELL=n

#PWM
CONFIG_PWM=y
CONFIG_PWM_NRFX=y

# radio_test
CONFIG_CONSOLE_HANDLER=y
CONFIG_DYNAMIC_INTERRUPTS=y
CONFIG_NRFX_TIMER0=y
CONFIG_NRFX_GPPI=y
CONFIG_CLOCK_CONTROL=y
CONFIG_ENTROPY_GENERATOR=y
CONFIG_NRF_SECURITY=y
# CONFIG_FEM=n (disabled, no FEM hardware)
# CONFIG_FEM_AL_LIB=y (not needed if FEM is disabled)
CONFIG_PICOLIBC_IO_FLOAT=y
CONFIG_SHELL_BACKEND_SERIAL_RX_RING_BUFFER_SIZE=1024

# 11.45 PPM clock
CONFIG_CLOCK_CONTROL_NRF_K32SRC_SYNTH=y